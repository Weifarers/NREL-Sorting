# NREL-Sorting

This code extracts publicly available Solar PV data from the NREL website, and uses it to map specific PV stations in synthetic data to real world locations. 
It also takes the average period over the course of a month.

The three files, File_Adjustment.py, Mapping.py, and Pattern_Calculating.py should be stored in their own self-contained folder. An example of this is: 

```
Project Folder
└─── Code Folder
│    ├── File_Adjustment.py
│    ├── Mapping.py
|    ├── Pattern_Calculating.py
└─── README.md
```
**This should be all you need to get started.**

## File_Adjustment.py
  - There are three functions available, but only two are necessary at any given time.
  
### Reading in Data
  - Using web_scrape() will take all the data directly from the NREL website, and extract it into a new folder, creating an architecture like the following:
  
```
Project Folder
└─── Code Folder
│    ├── File_Adjustment.py
│    ├── Mapping.py
|    ├── Pattern_Calculating.py
└─── Data
│    └─── Raw Data
|    |    └─── Subfolders for each of the states taken from the NREL Website
└───README.md
```
  - Using unzip() assumes you have access to all the ZIP files already, and creates an architecture like the following:
  ```
Project Folder
└─── Code Folder
│    ├── File_Adjustment.py
│    ├── Mapping.py
|    ├── Pattern_Calculating.py
└─── Data
│    └─── Raw Data
|    |    └─── Subfolders for each of the ZIP files you have.
└─── ZIP Files
|    ├── All the ZIP files you have downloaded.
└───README.md
```
  Note that you should already have created the "ZIP Files" folder before running the code if you choose to use the unzip() function.
  
### Filtering Data

The NREL data is substantial but only a few files are actually necessary. data_filter() filters out any files that contain keywords we don't want, and keeps the
rest stored in a separate location. 

The code also creates a reference file, Filtered_State.csv, which contains what state each filtered file is located in. This is used for sanity checking.

## Mapping.py

The Mapping.py file maps input data from an input CSV generated from PowerWorld. The structure of the CSV columns can be one of two choices:

| Number of Bus | ID | Substation Latitude | Substation Longitude |
| ------------- | -- | ------------------- | -------------------- |

OR

| Gen           |    |                     |                      |
| ------------- | -- | ------------------- | -------------------- |
| Number of Bus | ID | Substation Latitude | Substation Longitude |

The latter is the one generated by PowerWorld by default. The former is one where the first row is removed. The output of the code is two files: 'Mapped Files.csv', which
tells you what file each bus in the PowerWorld data set was mapped to, and 'Reference Data.csv', which is a sanity checking file for latitude and longitude, and making sure
that the mapping is roughly in the same geographical state as anticipated. 

## Pattern_Calculating.py

This file takes all the files that were mapped, and then averages out the behavior over a specific month to assign to each PowerWorld bus. The default month chosen is 05 - May.
The output of the code is two files: 'Average Per File.csv', which tells you, per each mapped file, what the average PV output was over a 24 hour period, and 
'Mapped Averages.csv', which tells you the same thing, but per each bus given in the PowerWorld input data.

# Example Folder Structure
An example folder structure at the end of running all three codes is as follows:
```
Project Folder
└─── Code Folder
│    ├── File_Adjustment.py
│    ├── Mapping.py
|    ├── Pattern_Calculating.py
|    ├── Filtered_State.csv
|    ├── Mapped Files.csv
|    ├── Reference Data.csv
|    ├── Average Per File.csv
|    ├── Mapped Averages.csv
└─── Data
│    └─── Mapped Data
|    |    └─── CSVs of all the files that were mapped to PowerWorld buses.
│    └─── Filtered Data
|    |    └─── CSVs of all the files that passed the filter.
│    └─── Raw Data
|    |    └─── Subfolders for each of the ZIP files you have.
└─── ZIP Files
|    ├── All the ZIP files you have downloaded.
└───README.md
```
